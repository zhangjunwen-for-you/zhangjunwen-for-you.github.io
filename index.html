<!DOCTYPE html>
<html>
    <head>
        <title>It's for you, ZJW</title>
        <link rel="shortcut icon" href="https://img.icons8.com/color/96/like--v1.png">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
            html, body {
                height: 100%;
                width: 100%;
                margin: 0;
                padding: 0;
            }

            #mtext {
                margin: auto;
                position: absolute;
                font-size: 88px;
                z-index: 100;
                width: 100%;
                text-align: center;
                top: 20%;
            }

            #mtext.thidden {
                display: none;
            }

            canvas {
                background: linear-gradient(
                    to bottom,
                    rgb(107, 48, 158),
                    rgb(145, 116, 1) 80%,
                    rgb(192, 92, 4));
                position: absolute;
                top: 0;
            }
        </style>
    </head>
    <body>
        <div id="mtext" class="thidden">
            ♥
        </div>
        <canvas id="canvas"></canvas>
        <script type="text/javascript">
            function Star(x,y,r,color) {
                this.x = x;
                this.y = y;
                this.r = r;
                this.rChange = 0.03;
                this.color = color;
            }

            Star.prototype = {
                constructor: Star,
                render: function() {
                    context.beginPath();
                    context.arc(this.x, this.y, this.r, 0, 2*Math.PI, false);
                    context.shadowBlur = 8;
                    context.shadowColor = "white";
                    context.fillStyle = this.color;
                    context.fill();
                },
                update: function() {
                    if (this.r > 2 || this.r < .8) {
                        this.rChange = -this.rChange;
                    }
                    this.r += this.rChange;
                }
            }

            var canvas = document.getElementById("canvas");
            var context = canvas.getContext("2d");

            var C_WIDTH = canvas.width = document.body.offsetWidth;
            var C_HEIGHT = canvas.height = document.body.offsetHeight;

            function randomColor(){
                    var arrColors = ["ffffff", "ffecd3" , "bfcfff"];
                    return "#"+arrColors[Math.floor((Math.random()*3))];
            }

            var arrStars = [];
            for(i = 0; i < 202; i++){
                var randX = Math.floor((Math.random()*C_WIDTH)+1);
                var randY = Math.floor((Math.random()*C_HEIGHT)+1);
                var randR = Math.random() * 1.3 + .5;

                var star = new Star(randX, randY, randR, randomColor());
                arrStars.push(star);
            }
            for(i = 0; i < 520; i++){
                var randX = Math.floor((Math.random()*C_WIDTH)+1);
                var randY = Math.floor((Math.random()*C_HEIGHT)+1);
                var randR = Math.random() * 0.5 + .3;

                var star = new Star(randX, randY, randR, randomColor());
                arrStars.push(star);
            }
            for(i = 0; i < 1314; i++){
                var randX = Math.floor((Math.random()*C_WIDTH)+1);
                var randY = Math.floor((Math.random()*C_HEIGHT)+1);
                var randR = Math.random() * 0.3 + .1;

                var star = new Star(randX, randY, randR, randomColor());
                arrStars.push(star);
            }

            function animate(){
                for(var i = 0; i < arrStars.length; i++) {
                    arrStars[i].update();
                }
                context.clearRect(0, 0, C_WIDTH, C_HEIGHT);
                for(var i = 0; i < arrStars.length; i++) {
                    arrStars[i].render();
                }
                requestAnimationFrame(animate);
            }

            var count = 0;
            var last_index = 0;
            function randomText(e) {
                var choices = ["♥", "Z", "J", "W", "D", "K", "Q", "♥", "Z", "J", "W", "D", "K", "Q"];
                if (count > 3) {
                    choices.push("D ♥ Z", "Z ♥ D");
                }
                var index = Math.floor(Math.random() * choices.length);
                if (index == last_index) {
                    index++;
                    last_index = index;
                }
                mtext.innerText = choices[index];
                var colorRed = Math.floor(Math.random()*200 + 1);
                var colorGreen = Math.floor(Math.random()*colorRed + 1);
                var colorBlue = Math.floor(Math.random()*30 + colorRed);
                mtext.style.color = "rgb("+colorRed + ", " + colorGreen + ", " + Math.min(colorBlue, 255) + ")";
                mtext.classList.remove("thidden");
                count++;
                return false;
            }

            function hideText(e) {
                mtext.classList.add("thidden");
                return false;
            }

            var day = [[8, 140, 235], [8, 140, 235], [8, 140, 235]];
            var dawn = [[107, 48, 158], [145, 116, 1], [192, 92, 4]];
            var night = [[3, 0, 17], [3, 0, 17], [3, 0, 17]];
            function computeBackground(grad1, grad2, point) {
                var bg = "linear-gradient(to bottom, ";
                for (var i = 0; i < 3; i++) {
                    var red = Math.floor(grad1[i][0] + (grad2[i][0] - grad1[i][0])*point);
                    var green = Math.floor(grad1[i][1] + (grad2[i][1] - grad1[i][1])*point);
                    var blue = Math.floor(grad1[i][2] + (grad2[i][2] - grad1[i][2])*point);
                    bg += "rgb("+red+", "+green+", "+blue+")";
                    if (i == 1) {
                        bg += " 80%";
                    }
                    if (i <= 1) {
                        bg += ", ";
                    }
                }
                bg += ")";
                return bg
            }

            function changeBackground() {
                var now = new Date();
                var nowHour = now.getHours();
                var nowMinutes = now.getMinutes();
                // var nowHour = now.getMinutes()%24+3;
                // var nowMinutes = now.getSeconds();
                var timePoint = nowHour * 60 + nowMinutes;
                var grad1, grad2, point, bg;
                if (timePoint >= 5*60+9 && timePoint < 5*60+39) {
                    grad1 = night;
                    grad2 = dawn;
                    point = (timePoint - (5*60+9))/30.0;
                    bg = computeBackground(grad1, grad2, point);
                } else if (timePoint >= 5*60+39 && timePoint < 6*60+9) {
                    grad1 = dawn;
                    grad2 = day;
                    point = (timePoint - (5*60+39))/30.0;
                    bg = computeBackground(grad1, grad2, point);
                } else if (timePoint >= 6*60+9 && timePoint < 18*60+19) {
                    bg = "rgb(8, 140, 235)";
                    grad1 = day;
                    grad2 = day;
                    point = 0;
                    bg = computeBackground(grad1, grad2, point);
                } else if (timePoint >= 18*60+19 && timePoint < 18*60+49) {
                    grad1 = day;
                    grad2 = dawn;
                    point = (timePoint - (18*60+19))/30.0;
                    bg = computeBackground(grad1, grad2, point);
                } else if (timePoint >= 18*60+49 && timePoint < 19*60+19) {
                    grad1 = dawn;
                    grad2 = night;
                    point = (timePoint - (18*60+49))/30.0;
                    bg = computeBackground(grad1, grad2, point);
                } else {
                    bg = "rgb(3, 0, 17)";
                    grad1 = night;
                    grad2 = night;
                    point = 0;
                    bg = computeBackground(grad1, grad2, point);
                }
                // console.log(nowHour, nowMinutes, timePoint, bg);
                canvas.style.background = bg;
            }

            function start_main() {
                changeBackground();
                setInterval(changeBackground, 1000);

                animate();

                document.oncontextmenu = (e) => {
                    e.preventDefault()
                    return false;
                }
                canvas.oncontextmenu = (e) => {
                    e.preventDefault()
                    return false;
                }
                mtext.oncontextmenu = (e) => {
                    e.preventDefault()
                    return false;
                }

                canvas.onmousedown = randomText;
                canvas.onmouseup = hideText;
                canvas.ontouchstart = randomText;
                canvas.ontouchend = hideText;
            }

            start_main();
        </script>
    </body>
</html>